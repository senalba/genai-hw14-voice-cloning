# Homework 16 ‚Äî Voice Cloning Metrics Evaluation

## üìÑ –ú–µ—Ç–∞
–î–æ—Å–ª—ñ–¥–∏—Ç–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö AI-–º–æ–¥–µ–ª–µ–π –¥–ª—è –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è –≥–æ–ª–æ—Å—É, –∑–æ—Å–µ—Ä–µ–¥–∂—É—é—á–∏—Å—å –Ω–∞ —ó—Ö–Ω—å–æ–º—É –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—ñ –≤ –∑–∞–¥–∞—á–∞—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –≤ –º–æ–≤–ª–µ–Ω–Ω—è (TTS).

---

## üìÇ Project Structure
```
genai-hw14-voice-cloning/
‚îú‚îÄ‚îÄ environment.yml
‚îú‚îÄ‚îÄ voice_cloning_script.py
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ input.csv
‚îÇ   ‚îú‚îÄ‚îÄ input.json
‚îÇ   ‚îî‚îÄ‚îÄ sample_voice.wav
‚îú‚îÄ‚îÄ out/
‚îÇ   ‚îî‚îÄ‚îÄ ... generated audio files ...
```

---

## ‚öôÔ∏è Setup
```bash
cd genai-hw14-voice-cloning
mamba env create -f environment.yml
```

---

## ‚ñ∂Ô∏è Usage
Run with CSV or JSON input:

```bash
# Example with CSV
python voice_cloning_script.py --input data/input.csv --voice data/sample_voice.wav --outdir out

# Example with JSON
python voice_cloning_script.py --input data/input.json --voice data/sample_voice.wav --outdir out

# Example with Text
python voice_cloning_script.py --text "This is a sample text to be spoken" --voice data/sample_voice.wav --outdir out --prefix "text_"
```

- **--input** : Path to CSV or JSON with text  
- **--voice** : Path to sample voice `.wav` for cloning  
- **--outdir** : Output folder (default: `out`)  
- **--prefix** : Prefix for output files (default: '') 

---

## üß™ Evaluation Criteria
1. **Similarity** ‚Äì Does the generated voice resemble the source speaker?  
2. **Naturalness** ‚Äì Is the speech fluent and free of robotic artifacts?  
3. **Intelligibility** ‚Äì Are words clear and easy to understand?  

---

## ‚úÖ Example
- Input:  
  `"Artificial intelligence can now replicate human voices with surprising accuracy."`

- Output:  
  `out/out_02.wav` ‚Äì cloned voice reading the sentence.

## Preprocessing
```bash
python -m demucs --two-stems=vocals -d cpu -n htdemucs_ft data/trump_short.wav

ffmpeg -y -i separated/htdemucs_ft/trump_short/vocals.wav -ar 22050 -ac 1 data/sample_voice.wav
```
---

## üìä –í–∏—Å–Ω–æ–≤–∫–∏

### –û—Ü—ñ–Ω–∫–∞:
- –°—Ö–æ–∂—ñ—Å—Ç—å: –Ω–∏–∑—å–∫–∞ ‚Äî —Ç–µ–º–±—Ä —ñ –º–∞–Ω–µ—Ä–∞ –ª–∏—à–µ —á–∞—Å—Ç–∫–æ–≤–æ –∑–±—ñ–≥–∞—é—Ç—å—Å—è; zero-shot XTTS –Ω–µ ¬´–≤–ª—É—á–∞—î¬ª –≤ –≥–æ–ª–æ—Å.
- –ü—Ä–∏—Ä–æ–¥–Ω—ñ—Å—Ç—å: –¥–æ–±—Ä–∞ ‚Äî —ñ–Ω—Ç–æ–Ω–∞—Ü—ñ—ó –π –ø–∞—É–∑–∏ –æ–∫, —ñ–Ω–∫–æ–ª–∏ —á—É—Ç–∏ –¥—Ä—ñ–±–Ω—ñ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ –Ω–∞ —Å–∫–ª–∞–¥–Ω–∏—Ö —Å–ª–æ–≤–∞—Ö.
- –†–æ–∑–±—ñ—Ä–ª–∏–≤—ñ—Å—Ç—å: –≤–∏—Å–æ–∫–∞ ‚Äî —Ç–µ–∫—Å—Ç –∑—Ä–æ–∑—É–º—ñ–ª–∏–π, —Å–ª—ñ–≤ –Ω–µ ¬´–∑‚Äô—ó–¥–∞—î¬ª.


–î–µ—Ç–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ (batch —ñ–∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ñ—Ä–∞–∑–∞–º–∏) –ª–∏—à–∞—î—Ç—å—Å—è –Ω–∞–π—ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ñ—à–∏–º: –≤—ñ–Ω –≤–∏—Ä–∞–∑–Ω–æ –ø–æ–∫–∞–∑—É—î —Å–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è —Ç–∞ —Å—Ç–∞–±—ñ–ª—ñ–∑—É—î –æ—Ü—ñ–Ω–∫—É.  
–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —è–∫–æ—Å—Ç—ñ –≤—ñ–¥ —Å–µ–º–ø–ª–∞: –∫–æ—Ä–æ—Ç–∫–∏–π —à—É–º–Ω–∏–π ‚Äî –ø–æ–≥–∞–Ω–æ; –∫–æ—Ä–æ—Ç–∫–∏–π –æ—á–∏—â–µ–Ω–∏–π ‚Äî –ø–æ–º—ñ—Ç–Ω–æ –∫—Ä–∞—â–µ; –¥–æ–≤—à–∏–π —á–∏—Å—Ç–∏–π –Ω–∞–π–∫—Ä–∞—â–∞ –ø—Ä–∏—Ä–æ–¥–Ω—ñ—Å—Ç—å —ñ —Ä–æ–∑–±—ñ—Ä–ª–∏–≤—ñ—Å—Ç—å, –∞–ª–µ **—Å—Ö–æ–∂—ñ—Å—Ç—å –¥–∞–ª–µ–∫–∞ –≤—ñ–¥ —ñ–¥–µ–∞–ª—É**.  
Zero-shot XTTS-v2 –¥–æ–±—Ä–µ —Ç—Ä–∏–º–∞—î —ñ–Ω—Ç–æ–Ω–∞—Ü—ñ—ó —Ç–∞ –¥–∏–∫—Ü—ñ—é, –æ–¥–Ω–∞–∫ —Ç–µ–º–±—Ä –∫–æ–ø—ñ—é—î –ª–∏—à–µ —á–∞—Å—Ç–∫–æ–≤–æ; –æ—á–∏—â–µ–Ω–Ω—è (–Ω–∞ –∫—à—Ç–∞–ª—Ç Demucs) –¥–æ–ø–æ–º–∞–≥–∞—î, –∞–ª–µ –Ω–µ –∑–∞–º—ñ–Ω—é—î –¥–æ–≤—à–∏–π —á–∏—Å—Ç–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª.  
–ü—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –º–æ–¥–µ–ª–ª—é –∑—Ä—É—á–Ω–æ (–æ–¥–∏–Ω –≤–∏–∫–ª–∏–∫), –ø—Ä–æ—Ç–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤–∏–º–æ–≥–ª–∏–≤—ñ: —Å—É–º—ñ—Å–Ω—ñ PyTorch/torchaudio —Ç–∞ `numpy<2` ‚Äî –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ.  
–°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏ open-source: –ª–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–∏–º–∏, –±–µ–∑ –ø–ª–∞—Ç–Ω–∏—Ö API, –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ç—é–Ω—ñ–Ω–≥—É —Ç–∞ –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω—ñ—Å—Ç—å.  
–ö—Ä–∏—Ç–∏—á–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏: —è–∫—ñ—Å—Ç—å —Ç–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Å–µ–º–ø–ª–∞, –∑–±—ñ–≥ –º–æ–≤–∏/–∞–∫—Ü–µ–Ω—Ç—É –π —Å—Ç–∏–ª—é –∑ —Ç–∞—Ä–≥–µ—Ç-—Ç–µ–∫—Å—Ç–æ–º, —Å—Ç–∞–±—ñ–ª—å–Ω–∞ –≥—É—á–Ω—ñ—Å—Ç—å, –º—ñ–Ω—ñ–º—É–º —à—É–º—É.  
–î–ª—è ¬´1:1¬ª —Å—Ö–æ–∂–æ—Å—Ç—ñ –≤–∞—Ä—Ç–æ –ø–ª–∞–Ω—É–≤–∞—Ç–∏ –¥–æ–Ω–∞–≤—á–∞–Ω–Ω—è (fine-tuning) –Ω–∞ –≤–ª–∞—Å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∞–±–æ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è/–≤–∞—Ä—ñ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å —á–∏—Å—Ç–∏—Ö —Å–µ–º–ø–ª—ñ–≤; –¥–ª—è –æ–∑–≤—É—á–∫–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –ø–æ—Ç–æ—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ —É–∂–µ –ø—Ä–∏–¥–∞—Ç–Ω–∏–π.
